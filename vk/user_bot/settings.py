from .utils import ExcReload, set_online_privacy
from database import VkDB
from vk.user_bot.admin.warnings import get_warns

from vk.running_on_tasks import rate_limit_friends


# TODO: –Ω—É —Ö–æ—Ç—è –±—ã –ø–æ –¥–ª–∏–Ω–µ —Ä–∞–∑–±–µ—Ä–∏—Å—å
def sets(nd, db: VkDB, vk, time):  # noqa
    message = nd[5]
    pid = nd[3]
    settings = db.settings_get()
    msg = 'üíÖüèª –ë—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n'

    if '+–∞–¥–≤–¥' in message:
        settings.friends_add = True
        msg += '‚úÖ –í–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–ø—Ä–∏–µ–º –∑–∞—è–≤–æ–∫ –≤ –¥—Ä—É–∑—å—è\n'
    elif '-–∞–¥–≤–¥' in message:
        settings.friends_add = False
        msg += '‚ùé –í—ã–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–ø—Ä–∏–µ–º –∑–∞—è–≤–æ–∫ –≤ –¥—Ä—É–∑—å—è\n'

    if '+–∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞' in message:
        settings.del_requests = True
        msg += '‚úÖ –í–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞\n'
    elif '-–∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞' in message:
        settings.del_requests = False
        msg += '‚ùé –í—ã–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞\n'

    if '+–æ–Ω–ª–∞–π–Ω' in message:
        if settings.offline: message += '-–æ—Ñ—Ñ–ª–∞–π–Ω'
        elif '+–æ—Ñ—Ñ–ª–∞–π–Ω' in message: message = message.replace('+–æ—Ñ—Ñ–ª–∞–π–Ω', '')
        settings.online = True
        msg += '‚úÖ –í–∫–ª—é—á–µ–Ω –≤–µ—á–Ω—ã–π –æ–Ω–ª–∞–π–Ω\n'
    elif '-–æ–Ω–ª–∞–π–Ω' in message:
        settings.online = False
        msg += '‚ùé –í—ã–∫–ª—é—á–µ–Ω –≤–µ—á–Ω—ã–π –æ–Ω–ª–∞–π–Ω\n'
   
    if '–æ—Ñ—Ñ–ª–∞–π–Ω' in message:
        if '+–æ—Ñ—Ñ–ª–∞–π–Ω' in message:
            if settings.online: settings.online = False
            if set_online_privacy(db):
                msg += '‚úÖ –û–Ω–ª–∞–π–Ω —Å–∫—Ä—ã—Ç\n'
                settings.offline = True
            else:
                msg += '‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ—Ñ—Ñ–ª–∞–π–Ω–∞\n'
        elif '-–æ—Ñ—Ñ–ª–∞–π–Ω' in message:
            if set_online_privacy(db, 'all'):
                msg += '‚úÖ –í–µ—á–Ω—ã–π –æ—Ñ—Ñ–ª–∞–π–Ω –≤—ã–∫–ª—é—á–µ–Ω\n'
                settings.offline = False
            else:
                msg += '‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–Ω—è—Ç–∏–∏ –æ—Ñ—Ñ–ª–∞–π–Ω–∞\n'

    if '+—Ä–µ–¥–∞—á' in message:
        settings.delete['editcmd'] = True
        msg += f'''‚úÖ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é "{settings.delete['deleter']}-" –∫–æ–º–∞–Ω–¥–∞ –±—É–¥–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è\n'''
    elif '-—Ä–µ–¥–∞—á' in message:
        settings.delete['editcmd'] = False
        msg += f'''‚ùé –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é "{settings.delete['deleter']}-" –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –±—É–¥–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è\n'''

    if '+—Ñ–µ—Ä–º–∞' in message:
        settings.farm['on'] = True
        settings.farm['soft'] = False
        msg += '‚úÖ –ê–≤—Ç–æ—Ñ–µ—Ä–º–∞ –≤–∫–ª—é—á–µ–Ω–∞\n'
    elif '-—Ñ–µ—Ä–º–∞' in message:
        settings.farm['on'] = False
        msg += '‚ùé –ê–≤—Ç–æ—Ñ–µ—Ä–º–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞\n'

    if '+—É–¥–ø—É—à–µ–π' in message:
        settings.mentions['mine'] = True
        msg += '‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—É—à, –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è\n'
    elif '-—É–¥–ø—É—à–µ–π' in message:
        settings.mentions['mine'] = False
        msg += '‚ùé –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—É—à, –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è\n'

    if '+—É–¥—Å–æ–±–∞–∫' in message:
        settings.dogs_del = True
        msg += '‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–∫–ª—é—á–µ–Ω–æ\n'
    elif '-—É–¥—Å–æ–±–∞–∫' in message:
        settings.dogs_del = False
        msg += '‚ùé –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç–∫–ª—é—á–µ–Ω–æ\n'

    if '+—É–¥–≤—Å–µ—Ö' in message:
        settings.mentions['all'] = True
        msg += '‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—É—à–∏ —Ç–∏–ø–∞ @–∞ll, –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è\n'
    elif '-—É–¥–≤—Å–µ—Ö' in message:
        settings.mentions['all'] = False
        msg += '‚ùé –°–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—É—à–∏ —Ç–∏–ø–∞ @–∞ll, –Ω–µ –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è\n'

    if '+–ø–æ–≤—Ç–æ—Ä—è–ª–∫–∞' in message:
        settings.repeater['on'] = True
        msg += '‚úÖ –ü–æ–≤—Ç–æ—Ä—è–ª–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ —Ç–µ –ª—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–º —Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ–≤–µ—Ä—è–µ—à—å!\n'
    elif '-–ø–æ–≤—Ç–æ—Ä—è–ª–∫–∞' in message:
        settings.repeater['on'] = False
        msg += '‚ùé –ü–æ–≤—Ç–æ—Ä—è–ª–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞\n'

    if '+–∞–≤—Ç–æ–≤—ã—Ö–æ–¥' in message:
        settings.leave_chats = True
        msg += '‚úÖ –ê–≤—Ç–æ–≤—ã—Ö–æ–¥ –∏–∑ –±–µ—Å–µ–¥ –≤–∫–ª—é—á–µ–Ω\n'
    elif '-–∞–≤—Ç–æ–≤—ã—Ö–æ–¥' in message:
        settings.leave_chats = False
        msg += '‚ùé –ê–≤—Ç–æ–≤—ã—Ö–æ–¥ –∏–∑ –±–µ—Å–µ–¥ –æ—Ç–∫–ª—é—á–µ–Ω\n'

    if '+–∞–≤—Ç–æ—Å—Ç–∞—Ç—É—Å' in message:
        if settings.autostatus_format == '':
            msg = '‚ö†Ô∏è –§–æ—Ä–º–∞—Ç—Ç–µ—Ä —Å—Ç–∞—Ç—É—Å–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'
        else:
            settings.autostatus_on = True
            msg += '‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤–∫–ª—é—á–µ–Ω–æ\n'
    elif '-–∞–≤—Ç–æ—Å—Ç–∞—Ç—É—Å' in message:
        settings.autostatus_on = False
        msg += '‚ùé –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–∫–ª—é—á–µ–Ω–æ\n'

    if message.startswith('–Ω–¥ –ø—Ä–µ—Ñ–∏–∫—Å '):
        if "\r" in message or "&" in message:
            msg = 'üòï –≠—ç—ç –Ω–µ, —á–µ–ª, –Ω–µ –Ω–∞–¥–æ —Ç–∞–∫ –¥–µ–ª–∞—Ç—å'
        elif message[11:].startswith(settings.delete['deleter']):
            msg = 'ü§î –ï—Å–ª–∏ –ø—Ä–µ—Ñ–∏–∫—Å –±—É–¥–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å —É–¥–∞–ª—è–ª–∫–∏, —Ç–æ –∫–∞–∫ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã?'
        elif message[11:].startswith('!!'):
            msg = ('ü§∑‚Äç‚ôÄ –ü—Ä–µ—Ñ–∏–∫—Å—ã —Å –¥–≤—É–º—è –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞–∫–∞–º–∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –∏ ' +
                   '–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å')
        elif message[11:].startswith('–Ω–¥'):
            msg = ('ü§∑‚Äç‚ôÄ "–Ω–¥" - —Å–ª—É–∂–µ–±–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å –∏ ' +
                   '–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–∞–∫ –∫–∞—Å—Ç–æ–º–Ω—ã–π')
        else:
            if ' ' in message[11:]:
                msg = 'ü§∑‚Äç‚ôÄ –ü—Ä–µ—Ñ–∏–∫—Å –Ω–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã'
            else:
                settings.prefix = f'{message[11:]} '
                msg = f'''‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å "{settings.prefix.replace(' ','')}"'''

    if message.startswith('–Ω–¥ –ø–æ–≤—Ç–æ—Ä—è–ª–∫–∞ '):
        if message[14:]:
            settings.repeater['prefix'] = message[14:]
            msg = f'''‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è–ª–∫–∏ "{settings.repeater['prefix']}"'''

    elif message.startswith('–Ω–¥ —É–¥–∞–ª—è–ª–∫–∞ '):
        if message[12:].startswith(settings.prefix):
            msg = 'ü§î –ï—Å–ª–∏ —É–¥–∞–ª—è–ª–∫–∞ –±—É–¥–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞, —Ç–æ –∫–∞–∫ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã?'
        else:
            for char in message[12:]:
                if char.isdigit():
                    msg = 'ü§∑‚Äç‚ôÄ –£–¥–∞–ª—è–ª–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä'
                    break
            if msg != 'ü§∑‚Äç‚ôÄ –£–¥–∞–ª—è–ª–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä':
                if message[12:] == '\r':
                    settings.delete['deleter'] = '&#13;'
                else:
                    settings.delete['deleter'] = message[12:]
                msg = f'''‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —É–¥–∞–ª—è–ª–∫–∞ "{settings.delete['deleter']}". –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å –Ω–µ–µ, –±—É–¥—É—Ç —Ä–∞—Å—Ü–µ–Ω–∏–≤–∞—Ç—å—Å—è, –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞ üíÉ'''

    elif message.startswith('–Ω–¥ —Ä–µ–¥–∞—á'):
        if message[8:]:
            if len(message[8:]) < 500:
                settings.delete['editor'] = message[8:].replace(' ', '', 1)
                msg = f'''‚úÖ –¢–µ–ø–µ—Ä—å –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é "{settings.delete['deleter']}-" —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ "{settings.delete['editor']}"'''
            else:
                msg = 'üòê –î–∞–≤–∞–π-–∫–∞ —É–ª–æ–∂–∏–º—Å—è –≤ 500 —Å–∏–º–≤–æ–ª–æ–≤'

    elif message == '–Ω–¥ —Å—Ç–∞—Ä—ã–π —Ä–µ–¥–∞—á':
        settings.delete['old_type'] = True
        msg = f'''‚úÖ –¢–µ–ø–µ—Ä—å –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é "{settings.delete['deleter']}-" —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Å–Ω–∞—á–∞–ª–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è, –∞ –ø–æ—Ç–æ–º —É–¥–∞–ª—è—Ç—å—Å—è –≤–º–µ—Å—Ç–µ'''

    elif message == '–Ω–¥ –Ω–æ–≤—ã–π —Ä–µ–¥–∞—á':
        settings.delete['old_type'] = False
        msg = f'''‚úÖ –¢–µ–ø–µ—Ä—å –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é "{settings.delete['deleter']}-" —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ —Ç—É—Ç –∂–µ —É–¥–∞–ª—è—Ç—å—Å—è'''

    if message == '–Ω–¥ –ø–æ–º–æ—â—å':
        vk.msg_op(1, pid, f"""
        –û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ - "{settings.prefix} –∫–æ–º–∞–Ω–¥—ã"

        –í—Å–µ –Ω–∏–∂–µ—É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤–≤–æ–¥—è—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º "–Ω–¥" –∏ –∑–Ω–∞–∫–∞–º–∏ +/-
        –ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª
        –ü—Ä–∏–º–µ—Ä: "–Ω–¥ +–æ–Ω–ª–∞–π–Ω +–∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞ -–∞–¥–≤–¥"

        –∞–¥–≤–¥ -- –∞–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥—Ä—É–∑—å—è
        –æ–Ω–ª–∞–π–Ω -- –≤–µ—á–Ω—ã–π –æ–Ω–ª–∞–π–Ω
        –æ—Ñ—Ñ–ª–∞–π–Ω -- —Å–∫—Ä—ã—Ç–∏–µ –æ–Ω–ª–∞–π–Ω–∞ (–±—ã–ª –≤ —Å–µ—Ç–∏ –Ω–µ–¥–∞–≤–Ω–æ)
        —É–¥—Å–æ–±–∞–∫ -- —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –¥—Ä—É–∑–µ–π —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
        –∞–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞ -- –æ—Ç–º–µ–Ω–∞ –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–∞—è–≤–æ–∫ –≤ –¥—Ä—É–∑—å—è
        —É–¥–ø—É—à–µ–π -- —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø—É—à–µ–º —Ç–µ–±—è
        —É–¥–≤—Å–µ—Ö -- —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø—É—à–∞–º–∏ —Ç–∏–ø–∞ @–∞ll
        –∞–≤—Ç–æ–≤—ã—Ö–æ–¥ -- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–∏ –≤ –±–µ—Å–µ–¥—É
        """.replace('    ', ''))

    elif msg == 'üíÖüèª –ë—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n':
        mentions_on = settings.mentions['all'] or settings.mentions['mine']
        mentions_all = settings.mentions['all'] and settings.mentions['mine']
        vk.msg_op(1, pid, f'''
        ü§ù –ê–≤—Ç–æ–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥—Ä—É–∑—å—è: {
            '‚ö†Ô∏è Rate limit' if rate_limit_friends.get(db.user_id) else
            ('‚úÖ' if settings.friends_add else '‚ùå')
        }
        üê∂ –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ "—Å–æ–±–∞—á–µ–∫": {'‚úÖ' if settings.dogs_del else '‚ùå'}
        üôÖ‚Äç‚ôÄ –ê–≤—Ç–æ–≤—ã—Ö–æ–¥ –∏–∑ –±–µ—Å–µ–¥: {'‚úÖ' if settings.leave_chats else '‚ùå'}
        üöØ –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—à–µ–π: {'‚ùå' if not mentions_on else '‚úÖ ' +
            '@–∞ll –∏ –ø—É—à–∏ –º–µ–Ω—è' if mentions_all else ('—Ç–æ–ª—å–∫–æ ' +
            '–ø—É—à–∏ –≤—Å–µ—Ö' if settings.mentions['all'] else '–ø—É—à–∏ –º–µ–Ω—è')}
        üë§ –í–µ—á–Ω—ã–π –æ—Ñ—Ñ–ª–∞–π–Ω: {'‚úÖ' if settings.offline else '‚ùå'}
        üë©‚Äçüíª –í–µ—á–Ω—ã–π –æ–Ω–ª–∞–π–Ω: {'‚úÖ' if settings.online else '‚ùå'}
        ‚õè  –ê–≤—Ç–æ—Ñ–µ—Ä–º–∞ –ò—Ä–∏—Å–∞: {'‚úÖ' if settings.farm['on'] else '‚ùå'}
        ü§¶ –ê–≤—Ç–æ–æ—Ç–ø–∏—Å–∫–∞: {'‚úÖ' if settings.del_requests else '‚ùå'}
        üë©‚Äçüîß –ê–≤—Ç–æ—Å—Ç–∞—Ç—É—Å: {'‚úÖ' if settings.autostatus_on else '‚ùå'}
        üìØ –ü–æ–≤—Ç–æ—Ä—è–ª–∫–∞: {f'‚úÖ –ü—Ä–µ—Ñ–∏–∫—Å: "{settings.repeater["prefix"]}"'
                        if settings.repeater['on'] else '‚ùå'}
        –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å: "{settings.prefix.replace(' ','')}"\n
        –£–¥–∞–ª—è–ª–∫–∞: "{settings.delete['deleter']}", —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ "{settings.delete['editor']}", {
            '–≤–º–µ—Å—Ç–µ —Å –∫–æ–º–∞–Ω–¥–æ–π' if settings.delete['editcmd'] else '–∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è'}\n
        {'<br>‚ö†Ô∏è –®–∞–±–ª–æ–Ω—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —á–∞—Ç—É<br>' if settings.templates_bind else '<br>'}
        –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ - "–Ω–¥ –ø–æ–º–æ—â—å"'''.replace('    ', '') + get_warns())
    else:
        db.settings_set(settings)
        raise ExcReload(pid=pid, text=msg, vk=vk)
